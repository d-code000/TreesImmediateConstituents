# Парсинг русских предложений методом непосредственных составляющих

Проект по компьютерной лингвистике для синтаксического анализа русских предложений с использованием метода непосредственных составляющих (Immediate Constituent Analysis). Строит деревья разбора на основе контекстно-свободных грамматик (CFG) и парсера NLTK ChartParser.

## Содержание

- [Возможности](#возможности)
- [Архитектура](#архитектура)
- [Установка](#установка)
- [Использование](#использование)

## Возможности

- **Два типа грамматик**:
  - **FrameGrammar** - семантический анализ на основе ситуационных фреймов (Агент, Событие, Пациент, Локация, Манера, Инструмент)
  - **MemberGrammar** - традиционный синтаксический анализ по членам предложения (Подлежащее, Сказуемое, Дополнение, Определение, Обстоятельство)

- **Два варианта POS-теггинга**:
  - **ManualPosTagger** - использует предопределенный словарь
  - **MorphyPosTagger** - автоматический морфологический анализ через pymorphy3

- Автоматическая токенизация и разбиение на предложения
- Генерация деревьев разбора с визуализацией
- Поддержка различных порядков слов в русском языке

## Архитектура

Проект построен по трехуровневой архитектуре:

### 1. Слой POS-теггинга (`src/pos/`)

Отвечает за определение частей речи:

```
PosTaggerInterface (абстрактный базовый класс)
    ├── ManualPosTagger (словарный POS-теггер)
    └── MorphyPosTagger (морфологический анализатор)
```

- **Интерфейс**: `.tag(word: str) -> str | None`
- **Теги**: `'NOUN'`, `'VERB'`, `'ADJF'`, `'ADVB'`, `'PREP'` и др.

### 2. Слой грамматик (`src/grammar/`)

Определяет синтаксическую структуру:

```
AbstractGrammar (базовый класс)
    ├── FrameGrammar (семантические фреймы)
    └── MemberGrammar (традиционные члены предложения)
```

**Ключевые методы**:
- `_build_word_pos_map()` - сопоставление токенов и POS-тегов
- `_map_pos_to_grammar_symbol()` - преобразование тегов в грамматические символы
- `_generate_lexical_rules()` - создание лексических правил типа `N -> 'собака' | 'кот'`
- `get_structural_rules()` - определение структурных правил (реализуется в подклассах)
- `to_cfg()` - генерация финальной CFG

### 3. Слой обработки (`src/`)

Оркестрирует процесс парсинга:

- **SentenceParser** - токенизация текста на предложения
- **process.py** - главная функция парсинга, объединяющая все компоненты

## Установка

### Требования

- Python 3.13+
- [uv](https://docs.astral.sh/uv/) - современный менеджер пакетов Python

### Установка uv

```bash
# Windows (PowerShell)
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"

# Linux/macOS
curl -LsSf https://astral.sh/uv/install.sh | sh
```

### Установка зависимостей

```bash
# Установка основных зависимостей
uv sync

# Установка с dev-зависимостями (для разработки и тестирования)
uv sync --group dev
```

### Зависимости

**Основные**:
- `nltk>=3.9.1` - токенизация и chart parsing
- `pymorphy3>=2.0.6` - русский морфологический анализ

**Dev-зависимости**:
- `pytest>=8.4.2` - фреймворк для тестирования

## Использование

### Точки входа

Проект предоставляет 4 готовых конфигурации в `src/entrypoints/`:

1. **main_frame_grammar_manual.py** - фреймовая грамматика + словарь
2. **main_frame_grammar_morphy.py** - фреймовая грамматика + pymorphy3
3. **main_member_grammar_manual.py** - грамматика членов предложения + словарь
4. **main_member_grammar_morphy.py** - грамматика членов предложения + pymorphy3

> **Настройка**: Тестовый текст и словарь для ручного POS-теггинга находятся в `src/entrypoints/__init__.py`. Вы можете изменить переменные `text` и `dictionary` для работы с собственными примерами.

### Запуск

```bash
# Запуск через uv (из корня проекта)
uv run python -m src.entrypoints.main_frame_grammar_manual

# Или активируйте виртуальное окружение
uv sync
.venv\Scripts\activate  # Windows
source .venv/bin/activate  # Linux/macOS
python -m src.entrypoints.main_frame_grammar_manual
```
